import { Callout } from "nextra-theme-docs";

# Gitlab Server o'rnatish va sozlash

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/banner.png)

Zamonaviy rivojlanish landshaftida samarali manba kodni boshqarish va continuous integration/continuous deployment(CI/CD) pipelinelari barcha o'lchamdagi dasturiy ta'minot loyihalari uchun muhim ahamiyatga ega. GitLab, open-source DevOps platformasi, CI/CD va loyiha boshqaruvi funksiyalarini yagona ilovaga muammosiz birlashtirgan kuchli tool sifatida ajralib turadi. Kichik startapda yoki yirik korxonada ishlayapsizmi, GitLab serverini o'rnatish jamoangizning unumdorligini va hamkorligini sezilarli darajada oshirishi mumkin.

Ushbu qo'llanma GitLab serverini o'rnatish va sozlash bo'yicha har tomonlama, bosqichma-bosqich yondashuvni taqdim etishga qaratilgan. Ushbu qo'llanmaning oxirida siz optimallashtirilgan sozlamalar va xavfsizlik konfiguratsiyasi bilan to'liq o'z ehtiyojlaringizga moslashtirilgan to'liq ishlaydigan GitLab sereverga ega bo'lasiz. Biz serverning dastlabki sozlamalari va talablaridan unumdorlikni oshirish va mustahkam xavfsizlikni ta'minlash uchun ilg'or konfiguratsiyalargacha hamma narsani qamrab olamiz.

Tajribali DevOps yoki ish jarayonini soddalashtirishga intilayotgan dasturchi bo'lasizmi, ushbu qo'llanma sizni GitLab serverini samarali joylashtirish va unga xizmat ko'rsatish uchun zarur bo'lgan bilim va vositalar bilan ta'minlaydi.

[GitLab](https://about.gitlab.com/) keng qamrovli DevOps platformasi bo'lib,software development, version control, va continuous integration/continuous deployment (CI/CD) uchun keng ko'lamli dasturlarni taqdim etadi.

Gitlabning asosiy xususiyatlari quyidagilar.

* **Version Control**
* **CI/CD Pipelinelar**
* **Project Management**
* **Security va Compliance**
* **Container Registry**
* **Integratsiyalar va Extensionlar**

O'z ehtiyojlaringiz uchun global [Gitlab](https://gitlab.com) foydalanishingiz mumkin yoki o'zingiz uchun Gitlab o'rnatiob olishingiz mumkin. Gitlab o'rnatishning ikki xil yo'li bor Gitlab clouddan foydalangan holda cloudan foydalanaish va self-hosted o'rnatish ya'ni o'zingizning serveringizga o'rnatib olish. Gitlabning ikkita versiyasi mavjud **GitLab CE (Community Edition)** va **GitLab EE (Enterprise Edition)**. Ushbu qo'llanmada biz **GitLab EE (Enterprise Edition)** self-hosted o'rnatamiz ya'ni o'z serverimizga Gitlab o'rnatamiz.


* **GitLab CE** Kichikroq jamoalar yoki open-source loyihalar uchun javob beradi, bu yerda byudjet cheklovlari muhim ahamiyatga ega va ilg'or korxona xususiyatlari muhim emas.
* **GitLab EE** Kengaytirilgan xavfsizlik, ishlash va qo'llab-quvvatlashni talab qiladigan yirik tashkilotlar uchun mo'ljallangan. Bu, ayniqsa, ilg'or CI/CD qobiliyatlari va keng qamrovli loyihalarni boshqarish vositalariga muhtoj bo'lgan korxonalar uchun foydalidir.

## Ishni boshlash

Ushbu amaliyotni amalga oshirish uchun bizga quyidagi minimum server talablaridagi server kerak bo'ladi.

<Callout type="info" emoji="">
**Minimum Server talabi**

| OS            | RAM            | CPU           | Xotira       | Static IP  |
| ------------- | -------------- | ------------- |------------- | ---------- |
| Ubuntu 20.04  | 8GB            | 4vCPU 2 core  | 80GB         | Ha kerak   |
</Callout>

## DNS sozlash
Gitlab server o'rnatishimiz uchun bizgda domen kerak bo'ladi. DNS hostingizdan domenga Gitlab ishlab turgan server static IP manzilini qo'shishingiz kerak bo'ladi.

Quyida [**ahost.uz**](https://www.ahost.uz/) DNS hostiga namuna ko'rsatilgan.

Kerakli domen sozlamalariga kirib **DNS xosting** bo'limga o'ting sizda quyidagi oyna ochilishi kerak.

![harbor](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/container/harbor-setup/dns.png)

Bu yerdan siz domen o'ziga yoki subdomenga Gitlab server static IP maznilini ko'rsatishingiz kerak bo'ladi. Bizda [**helm.uz**](https://helm.uz) domenimiz bor keling unga **gitlab** subdomeni qo'shamiz.

* **Name->** subdomen nomi
* **Type->** A
* **TTL->** 14440
* **RDATA->** gitlab server Static IP manzili

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/dns.png)


## Gitlab o'rnatish

DNS sozlab olganimizdan keyin Gitlab serverni o'rnatish boshlasak bo'ladi ushbu qadamda biz **GitLab CE (Community Edition)** va **GitLab EE (Enterprise Edition)** o'rnatishni ko'rib chiqamiz.

### GitLab CE o'rnatish

**1->** Serverni yangilab olamiz.

```bash
sudo apt update && sudo apt upgrade -y
```

**2->** Kerakli dasturlarni o'rnatib olamiz.

```bash
sudo apt-get install -y curl openssh-server ca-certificates tzdata perl
```

**3->** Notificationlarni yuborish uchun **Postfix** (yoki **Sendmail**)ni o'rnatamiz.

```bash
sudo apt-get install -y postfix
```
**Postfix**-ni o'rnatish vaqtida konfiguratsiya ekrani paydo bo'lishi mumkin. **"Internet Site"** ni tanlang va Enter tugmasini bosing. "System mail name" uchun serveringizning tashqi DNS-dan foydalaning va Enter tugmasini bosing. Agar qo'shimcha ekranlar paydo bo'lsa, standart sozlamalarni qabul qilish uchun Enter tugmasini bosing.

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab1.png)

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab2.png)

**4->** Gitlab CE o'rnatamiz

```bash
curl -s https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
sudo EXTERNAL_URL="https://gitlab.helm.uz" apt-get install gitlab-ce
```
Bu buyruqni ishga tushirganimizdan keyin gitlab o'rnatilshi boshlanadi va biroz vaqt oladi. Gitlab muvaffaqiyatli o'rnatilganda sizda quyidagi natija chiqishi kerak.
![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab.png)

Bundan yuqorida esa sizga note(qayd) yozilgan bo'ladi Gitlabga admin bo'lib kirish uchgun `root` user va paroli yozilgan faylni ko'rstadi(`/etc/gitlab/initial_root_password`).
![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab3.png)

**5->** Belgilagan domenimiz orqali brauzerdan kiramiz biznig holatda **gitlab.helm.uz**. Brauzerda quyidagi Gitlab login qilish page ochilishi kerak. Biz yuqorida ko'rastilgandek `root` user bilan kiramiz parolni esa `/etc/gitlab/initial_root_password` falidan olamiz.

parolni olamiz.

```bash
sudo cat /etc/gitlab/initial_root_password
```
Admin login parolni yozib kiramiz.
![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab-ce.png)

Bizda quyidagi **Welcome to Gitlab** page ochiladi.

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab-ce1.png)

Admin panel orqali info olishimiz mumkin. **gitlab.helm.uz/admin**

![gitlab-ci](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/gitlab-server/gitlab-ce2.png)