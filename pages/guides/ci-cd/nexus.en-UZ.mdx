---
image: https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/banner.png
description: "Java Spring Boot Deployment: Gitlab CI va Github Actions"
---

import { Callout } from "nextra-theme-docs";
import { Tabs, TabList, Tab, TabPanel } from 'react-tabs';
import 'react-tabs/style/react-tabs.css';

# Sonatype Nexus Repository Manager

![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/banner.png)

## Kirish

Bugungi software development jarayonlarida CI/CD (Continuous Integration/Continuous Deployment) jarayonlarini samarali yuritish muhim ahamiyat kasb etadi. Bunday jarayonlarda paketlar va artifaktlarni boshqarish uchun maxsus repository managerlar kerak bo'ladi. **Sonatype Nexus Repository Manager** - eng ommabop va ishonchli artifakt menejerlardan biri bo'lib, Java (Maven, Gradle), .NET (NuGet), Python (PyPi), Docker va boshqa paketlarni saqlash va boshqarish uchun eng mashhur va ishonchli yechimlardan biridir.

Nexus opensource **(Nexus OSS)** va pullik **(Nexus Pro)** versiyalarda mavjud bo'lib, ushbu qo'llanma asosan **Nexus OSS** bilan ishlashga yo'naltirilgan.

**Sonatype Nexus Repository Manager** dasturi dastlab 2007-yilda **Sonatype Inc**. tomonidan ishlab chiqilgan. U dasturiy ta'minot artifaktlarini saqlash, boshqarish va tarqatish uchun mo'ljallangan markazlashtirilgan repository menejeri sifatida ishlab chiqilgan.

Nexus Repository Manager dasturiy ta'minot ishlab chiqishda artifaktlar va paketlarni saqlash, boshqarish hamda ularga kirishni ta'minlash uchun ishlatiladi. Java (Maven, Gradle), .NET (NuGet), Node.js (NPM), Docker, Python (PyPi) kabi texnologiyalar uchun artifaktlarni markazlashtirilgan holda saqlaydi va boshqaradi.Tashqi repository'lardan yuklash jarayonlarini tezlashtirish va tarmoq yuklamasini kamaytirish imkonini beradi va Korxona ichki(local) repository'sini yaratishi, Kompaniyaning o'ziga xos kutubxonalarini(library) boshqarish, xavfsizlikni ta'minlash va dasturiy ta'minot jarayonlarini optimallashtirish uchun ishlatiladi.


Bu amaliyotda biz **Sonatype Nexus Repository Manager**ni docker yordamida o'rnatish va sozlashni va loyihalarimizga va CI/CD ga integratsiya qilishni ko'rib chiqamiz.


## Nexus o'rnatish

Bu amaliyotda biz **Nexus**ni docker yordamida ishga tushiramiz va o'rnatishning manual va ansible yordamida qilishni ko'rib chiqamiz.
<Callout type="info" emoji="">
**Minimum Server talabi**

| OS            | RAM            | CPU           | Xotira       | Static IP  |
| ------------- | -------------- | ------------- |------------- | ---------- |
| Ubuntu 20.04 yoki Rocky Linux 8 | 8GB          | 4  | 80GB         | Ha kerak   |
</Callout>
Quyidagi qo'llanmadan foydalanib Docker o'rnatib olishingiz mumkin - [**Docker o'rnatish**](https://devops-journey.uz/guides/konteyner/docker-ornatish)


<Tabs>
<TabList>
<Tab>Manual</Tab>
<Tab>Ansible</Tab>
</TabList>
<TabPanel>
### Manual o'rnatish
**1->** Nexusni docker orqali o'rnatayotganimiz sababli nexus malumotlarini docker volume yoki hostpath qilib saqlashimiz kerak bo'ladi aks holda nexus container restart bo'lganda malumotlar o'chib ketadi shuning uchun nexusga data papka ochib olamiz.
```bash
sudo mkdir -p /mnt/nexus/nexus-data
sudo chown -R 200 /mnt/nexus/nexus-data
```
**2->** Nexusni docker yordamida ishga tushiramiz va `nexus-data`ni serverimizdagi `/mnt/nexus/nexus-data`ga ulab qo'yamiz va `--restart=always` flagi orqali tasodifan server yoki docker  restart bo'lganda avtomatik ishga tushirilishini belgilaymiz.

```bash
docker run -d -p 8081:8081 --name nexus --restart=always -v /mnt/nexus/nexus-data:/nexus-data sonatype/nexus3
```
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/1.png)

**3->** Nexusni ishga tuhsirganimizdan keyin u default admin user va parol bilan birga keladi, admin parolni olish uchun quyidagicha amalni bajaramiz.

```bash
docker exec -it nexus cat /nexus-data/admin.password
```
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/2.png)
</TabPanel>
<TabPanel>
### Ansible bilan o'rnatish

**1->** **[github.com/ismoilovdevml/infra-as-code]**(https://github.com/ismoilovdevml/infra-as-code) repositoriyani git clone qilib olamiz bu repositoriyada ko'plab ansible playbooklar bor shu jumladan nexus uchun ham.

```bash
git clone https://github.com/ismoilovdevml/infra-as-code.git
```
**2->** Nexus playbokga o'tamiz.

```bash
cd infra-as-code/Ansible/nexus
```

```bash
├── ansible.cfg
├── cleanup_nexus_docker.yml
├── install_nexus.yml
├── invnetory.ini
└── vars.yml
```

`vars.yml` faylida variablelar berilgan bo'ladi, bunda nexus image, nexus data papkasi, nexus container nomi, nexus porti, nexus admin parol fayli va nexus parent papkasi berilgan.

```yaml filename="vars.yml"
---
nexus_image: "sonatype/nexus3:latest"
nexus_data_dir: "/mnt/nexus/nexus-data"
nexus_container_name: "nexus"
nexus_port: 8081
nexus_admin_password_file: "/nexus-data/admin.password"
nexus_parent_dir: "/mnt/nexus"
```

**4->** `inventory.ini` faylida serverlarimizni yozamiz, bu holda serverlarga ssh key bilan ulanadi.

```ini filename="inventory.ini"
[nexus_servers]
nexus-server ansible_host=159.89.94.148 ansible_user=root
```
Agar siz parol bilan ulanmoqchi bo'lsangiz quyidagicha yozishingiz mumkin.

```ini filename="inventory.ini"
[nexus_servers]
nexus-server ansible_host=159.89.94.148 ansible_user=root ansible_password=your_password
```

**5->** Asosiy ikkita playbook bor, bular `install_nexus.yml` va `cleanup_nexus_docker.yml` bu playbooklar orqali nexusni o'rnatish va o'chirishni bajaramiz. Playbookni ishga tushirishdan oldin kerakli ansible collectionlarni o'rnatishimiz kerak yani `community.docker` va `community.general` collectionlarini o'rnatishimiz kerak.

```bash
ansible-galaxy collection install community.general -f
ansible-galaxy collection install community.docker -f
```

**6->** Nexusni o'rnatish uchun quyidagicha playbookni ishga tushiramiz.

```bash
ansible-playbook -i inventory.ini install_nexus.yml
```
Playbook muvaffaqiyatli ishga tushirilgandan keyin default `admin` user parolini ko'rsatadi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/11.png)

</TabPanel>
</Tabs>

Nexusni o'rnatib bo'lganimizdan keyin brauzerda `server_ip:8081` manzilini ochganimizda Nexus ochilishi kerak.

![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/3.png)

Bu qismda **->Sign in** bosib Nexusning login sahifasiga o'tamiz.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/4.png)
Default `admin` user va generatsiya qilingan default parol bilan kiramiz.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/5.png)
Bu qismda esa default parol o'rniga o'zimiz yangi parol qo'yishni talab qiladi yangi parolni yozib kiritamiz.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/6.png)
Bu qismda o'zimizga kerak tanlovni tanlaymiz.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/7.png)
Sizda `admin` user bilan kirganingizdan keyin sizda quyidagicha dastlabki sahifa ochiladi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/8.png)

## Nexus bilan tanishuv

Nexus Repository Manager **APT, Cargo, Bower CocoaPods, Composer, Conan, Conda, Docker, Git LFS, Go, Helm, Hugging Face, Maven, npm, NuGet, p2, PyPI, R, Raw, RubyGems, Yum(RPM)** kabi texnologiyalar uchun repositorylar yaratish va boshqarishni qo'llab-quvvatlaydi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/37.png)

**Sonatype Inc**ning **Sonatype Nexus Repository**dan tashqari **Sonatype Repository Firewall**, **Sonatype Lifecycle** va **Sonatype SBOM** kabi service'lari  ham mavjud.

![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/38.png)
Nexusga kirganimizda asosiy sahifa ochiladi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/8.png)
**-> Server Administration and Configuration** bo'limida server va konfiguratsiyalarini o'zgartirish imkoniyati mavjud.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/15.png)
**-> Blob Stores** bo'limida Nexusning fayllarni saqlash uchun ishlatiladigan papkalarni ko'rishimiz mumkin, bizning holda `default` papkasi(blobstore) mavjud.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/16.png)
**-> Repository** bo'limida repositorylarimizni ko'rishimiz mumkin, nexusda default **maven-public, maven-central, maven-releases, maven-snapshots, nuget-group, nuget-hosted, nuget.org-proxy** repositorylar mavjud.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/17.png)

Agar siz kompaniyangizda **Proxy** bilan internetga chiqish talab qilinsa **-> Settings -> System -> HTTP** bo'limiga o'tib proxy sozlashimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/18.png)
**HTTP Proxy** uchun `Enable HTTP Proxy`ni belgilaymiz va `HTTP Proxy Host` ga proxy serverimiz addresi va `HTTP Proxy Port` ga portni kiritamiz.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/19.png)
**HTTPS Proxy** uchun `Enable HTTPS Proxy`ni belgilaymiz va `HTTPS Proxy Host`ga proxy serverimiz addresi va `HTTPS Proxy Port` ga portni kiritamiz. Agar sizning proxyyingiz **HTTPS Authentication**ni talab qilinsa `Enable HTTPS Proxy Authentication`ni belgilaymiz va `HTTPS Proxy Username` va `HTTPS Proxy Password`ni kiritib ishlatishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/20.png)
Nexus servergfa proxy sozlamalarini sozlagandan keyin proxysiz ulanaidgan local sercvicelarimizga **NO Proxy Hosts** qismida yozishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/21.png)

## Repositorylar bilan ishlash

**Sonatype Nexus Repository Manager** repositoriyalarni tashkil qilish va boshqarish uchun turli xil turlarni(repo type) qo'llab-quvvatlaydi, ulardan eng asosiylari **Proxy, Hosted va Group** repository'laridir.

**Proxy** typedagi repository - tashqi (remote) repository'larni mahalliy (local) server orqali kechlashtirish (cache) va ulardan foydalanishni optimallashtirish uchun ishlatiladi. U **Maven Central, NuGet Gallery, Docker Hub, NPM Registry, PyPi** va boshqa repository'lardan paketlarni olish uchun qo'llaniladi. Bu turdagi repositoriyaning asosiy maqsadi internetga chiqishni kamaytirish va local serverda paketlarni saqlashdir, loyihamiz nexusga ulanganidna keyin u paketlarni yuklab olish uchun birinci bo'lib nexusga so'rov yuboradi agar loyiha so'ragan package nexus local repositoriyada bo'lmasa **Proxy** typedagi repositoriya berilgan **remote repository**dan oladi va nexus local repositoriyada cache qilib saqlaydi.

**Hosted** typedagi repository - lokal serverda paketlarni saqlash uchun ishlatiladi. U **Maven, NuGet, Docker, PyPi** va boshqa paketlarni saqlash uchun ishlatiladi. Bu turdagi repositorylar loyihalarga xizmat qilish uchun ishlatiladi, loyiha paketlarini yuklash uchun ishlatiladi.  Bu turdagi repositoriyaning asosiy maqsadi Kompaniya uchun maxsus yozilgan packagelar uchun local repository bo'lib xizmat qiladi.

**Group** repository - bu bir nechta repository'larni bitta umumiy repositoriya sifatida boshqarish imkonini beruvchi repository turi. Group repository bir vaqtning o'zida **Proxy, Hosted** va boshqa repositoriyalarni bitta URL orqali boshqarishga yordam beradi. Bu turdagi repositoriya ishlatishga bitta misol: maslan sizda **maven-central, maven-releases, maven-snapshots** repositorylar mavjud bo'lsa siz ularni bitta **maven-public** repositoryda birlashtirib qo'yishingiz mumkin va loyihalarga bitta URL orqali boshqarish imkonini beradi, yani siz loyihangizni Nexusga ulaganingizda bitta **maven-public** repositoriyani belgila ishlatishingiz mumkin uching ichida esa **maven-central, maven-releases, maven-snapshots** repositorylar mavjud bo'ladi.


Nexusda default holda **Maven va Nuget** uchun **Proxy, Hosted** va **Group** repositorylar mavjud bo'ladi, **Python, Go, Docker, Cargo** va boshqalar uchun o'zingiz repositorylar yaratishingiz kerak bo'ladi.

**Proxy** repositoriyalar vazifasi 

**-> Server Administration and Configuration** bo'limidan **-> Repositories** bo'limiga o'tib repositorieslarni ko'rishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/15.png)
Nexus default repositoriyalar.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/17.png)
Keling masalan **maven-central** repositoryni ko'rib chiqamiz. Bu repository turi **Proxy** bo'lib internetdan **https://repo1.maven.org/maven2/** manzilidan ma'lumotlarni olish uchun ishlatiladi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/22.png)
Quyidagi rasmda maven packagelarni qaysi global repositorydan olishini ko'rishimiz mumkin **https://repo1.maven.org/maven2/**.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/23.png)

![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/24.png)

**maven-public** repository **group** repository bo'lib **maven-central, maven-releases, maven-snapshots** repositorylarini birlashtirgan repository bo'lib, bu repositorydan maven packagelarni olishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/25.png)
Bu rasmda **maven-public** repositoriyamiz o'z ichiga olgan **maven-central, maven-releases, maven-snapshots** repositorylarini ko'rishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/26.png)
**nuget-group** repository ham **group** repository bo'lib **nuget-hosted, nuget.org-proxy** repositorylarini birlashtirgan repository bo'lib, bu repositorydan nuget packagelarni yani .NET packagelarni olishimiz mumkin.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/27.png)
**nuget.org-proxy** repository **proxy** repository bo'lib **https://api.nuget.org/v3/index.json** addresidan nuget packagelarni olish uchun ishlatiladi.
![nexus](https://raw.githubusercontent.com/devops-journey-uz/assets/main/images/tutorials/ci-cd/nexus/28.png)