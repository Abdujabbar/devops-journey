import { Callout } from "nextra-theme-docs";

# Kubernetes Arxitekturasi

![k8s](/images/tutorials/k8s/architecture/1.jpg)

<Callout type="info" emoji="">
**Mundarija**

**Kubernetes Arxitekturasi**

* Control Plane
* Worker Node

**Kubernetes Control Plani komponentlari**

* kube-apiserver
* etcd
* kube-scheduler
* Kube Controller Manager
* Cloud Controller Manager (CCM)

**Kubernetes Worker Node komponentlari**

* Kubelet
* Kube proxy
* Container Runtime

**Kubernetes Cluster Addon komponentlari**

* CNI Plugin


* Kubernetes Arxitekturasi boʻyicha tez-tez soʻraladigan savollar
* Kubernetes control planening asosiy maqsadi nima?
* Kubernetes clusteridagi worker nodelarining maqsadi nima?
* Kubernetes-da control plane va worker nodelari o'rtasidagi aloqa(communication) qanday ta'minlanadi?
* Kubernetesdagi `etcd` key-value storening maqsadi nima?
* Agar etcd ishlamay qolsa, Kubernetes applicationlari bilan nima sodir bo'ladi?
* Xulosa
</Callout>

## Kubernetes Arxitekturasi

Quyidagi Kubernetes arxitektura diagrammasi Kubernetes clusterining barcha komponentlarini va tashqi tizimlarning Kubernetes clusteriga qanday ulanishini ko'rsatadi.

![k8s](/images/tutorials/k8s/architecture/3.png)

Kubernetes haqida tushunishingiz kerak bo'lgan birinchi va eng muhim narsa - bu `distributed system`(taqsimlangan tizim). Ya'ni, u tarmoq orqali turli serverlar bo'ylab tarqalgan bir nechta komponentlarga ega. Bu serverlar virtual mashinalar(vm virtual machine) yoki bare metal serverlar bo'lishi mumkin. Biz uni `Kubernetes Clusteri` deb ataymiz.

Kubernetes clusteri control plane nodelari va worker nodelardan iborat.

![k8s](/images/tutorials/k8s/architecture/4.png)

Quyidagi rasmda Kubernetes Container tashuvchi kema sifatida ko'rsatilgan. 

### Control Plane

Control plane konteyner orkestratsiyasi(container orchestration) va clusterning kerakli holatini(state) saqlab turish uchun javobgardir. U quyidagi tarkibiy qismlarga ega.

<Callout type="info" emoji="">
* kube-apiserver
* etcd
* kube-scheduler
* kube-controller-manager
* cloud-controller-manager
</Callout>

### Worker Node

Worker nodelari konteynerlashtirilgan applicationlarni(ilovala) ishga tushirish uchun javobgardir. Worker node quyidagi komponentlarga ega.

<Callout type="info" emoji="">
* kubelet
* kube-proxy
* Container runtime
</Callout>

## Kubernetes Control Plane Komponentlari

Birinchidan, har bir control plane komponentini va har bir komponent ortidagi muhim tushunchalarni ko'rib chiqaylik.

###  kube-apiserver

`kube-api` serveri Kubernetes API-ni ochib(expose) beruvchi Kubernetes clasterining central hubidir. Oxirgi foydalanuvchilar va boshqa cluster komponentlari API serveri orqali cluster bilan gaplashadi. Juda kamdan-kam hollarda monitoring tizimlari va uchinchi tomon xizmatlari cluster bilan o'zaro aloqa qilish uchun API serverlari bilan gaplashishi mumkin. Shunday qilib, siz clusterni boshqarish uchun `kubectl` dan foydalansangiz, backendda siz `HTTP REST API` orqali API serveri bilan bog'lanasiz. Biroq, scheduler(rejalashtiruvchi), controller va boshqalar kabi ichki cluster komponentlari `gRPC` yordamida API serveri bilan gaplashadi. API serveri va clusterdagi boshqa komponentlar o'rtasidagi aloqa clusterga ruxsatsiz kirishni oldini olish uchun `TLS` orqali amalga oshiriladi.

![k8s](/images/tutorials/k8s/architecture/2.png)

Kubernetes `api-server`i quyidagilar uchun javobgardir

* API management(boshqaruvi): Cluster API so'nggi nuqtasini ochib beradi va barcha API so'rovlarini bajaradi.
* Autentifikatsiya (client sertifikatlari, tashuvchi tokenlari(bearer token) va HTTP asosiy autentifikatsiyasidan foydalanish) va avtorizatsiya (ABAC va RBAC evaluation).
* API soʻrovlarini(request) qayta ishlash va API obʼyektlari kabi pods, servicelar va boshqalar uchun maʼlumotlarni tekshirish (Validation and Mutation Admission Controllers)
* Bu etcd bilan aloqa(communicate) qiladigan yagona komponent.
* api-server control plane va worker node komponentlari o'rtasidagi barcha jarayonlarni(process) muvofiqlashtiradi.
* api-serverda o'rnatilgan bastion apiserver proksi-server mavjud. Bu API server jarayonining bir qismidir. U asosan clusterdan tashqaridan ClusterIP servicelariga kirishni ta'minlash uchun ishlatiladi, garchi bu servicelar odatda faqat clusterning o'zida mavjud bo'lsa ham.

### etcd

![k8s](/images/tutorials/k8s/architecture/5.png)
Kubernetes distributed system bo'lib, uning distributed(taqsimlangan) tabiatini qo'llab-quvvatlaydigan `etcd` kabi samarali distributed databaselar bazasiga muhtoj. U ham backend xizmatini kashf qilish, ham ma'lumotlar bazasi sifatida ishlaydi. Siz uni Kubernetes clusterining miyasi deb atashingiz mumkin.

[`etcd` open source](https://github.com/etcd-io/etcd) kuchli izchil, distributed key-value storedir. Xo'sh, bu nimani anglatadi?